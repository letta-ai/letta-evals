{
  "skill_name": "document-skills/xlsx",
  "task": "I'm preparing a budget variance analysis report for our department. Here's our annual budget data and actual spending:\n\n**Q1 Budget vs Actuals:**\n- Salaries: Budget $450,000, Actual $462,000\n- Software Licenses: Budget $85,000, Actual $78,500\n- Office Expenses: Budget $32,000, Actual $35,200\n- Travel: Budget $28,000, Actual $19,600\n- Training: Budget $45,000, Actual $41,000\n\n**Q2 Budget vs Actuals:**\n- Salaries: Budget $450,000, Actual $468,000\n- Software Licenses: Budget $85,000, Actual $82,000\n- Office Expenses: Budget $32,000, Actual $31,500\n- Travel: Budget $28,000, Actual $33,400\n- Training: Budget $45,000, Actual $38,000\n\n**Q3 Budget vs Actuals:**\n- Salaries: Budget $465,000, Actual $471,000\n- Software Licenses: Budget $90,000, Actual $88,200\n- Office Expenses: Budget $34,000, Actual $36,800\n- Travel: Budget $30,000, Actual $28,700\n- Training: Budget $48,000, Actual $52,500\n\n**Q4 Budget vs Actuals:**\n- Salaries: Budget $465,000, Actual $475,000\n- Software Licenses: Budget $90,000, Actual $91,500\n- Office Expenses: Budget $34,000, Actual $33,100\n- Travel: Budget $30,000, Actual $34,800\n- Training: Budget $48,000, Actual $46,000\n\nCreate a comprehensive budget variance analysis workbook with the following sheets:\n\n1. **Budget Data** sheet: Organize all quarterly budget and actual data in a structured table format with columns for Quarter, Category, Budget Amount, and Actual Amount.\n\n2. **Variance Analysis** sheet: Calculate variance amounts (Actual - Budget) and variance percentages (Variance/Budget) for each category in each quarter using formulas. Include quarterly totals and identify whether each variance is favorable (under budget) or unfavorable (over budget) for expense categories.\n\n3. **Annual Summary** sheet: Calculate annual totals by category showing total budgeted amount, total actual spending, total variance amount, and variance percentage. Include a section showing which categories had the highest absolute variance and percentage variance using formulas to identify them.\n\n4. **Trend Analysis** sheet: Show quarter-over-quarter changes in actual spending for each category, calculating both the absolute change and percentage change between consecutive quarters.\n\nAll calculations must use Excel formulas referencing the appropriate cells - no hardcoded calculated values. Apply proper formatting: currency should display with dollar signs and thousand separators with zeros shown as dashes, percentages should show one decimal place, and use color coding where appropriate (unfavorable variances could be highlighted). Place all threshold assumptions (such as materiality thresholds) in separate assumption cells. The workbook must have zero formula errors after recalculation.",
  "rubric_task_completion": "1. The workbook contains all four required sheets (Budget Data, Variance Analysis, Annual Summary, and Trend Analysis) with properly organized data and calculations.\n2. The Variance Analysis sheet correctly calculates both variance amounts and variance percentages for each category and quarter using formulas, and identifies favorable vs unfavorable variances.\n3. The Annual Summary sheet provides annual totals by category and identifies categories with highest variances using formulas (not hardcoded values).\n4. The Trend Analysis sheet shows quarter-over-quarter changes in actual spending with both absolute and percentage changes calculated using formulas.",
  "rubric_skill_use": "1. The agent identifies and selects the xlsx skill as relevant to the task.\n2. The agent loads the SKILL.md file for the xlsx skill to understand spreadsheet creation workflows and requirements.\n3. The agent loads and uses the recalc.py script to recalculate all formulas and verify zero formula errors in the completed workbook.\n4. The agent appropriately uses openpyxl for creating the workbook with formulas and formatting, follows the color coding and formatting standards from the skill (currency formatting, zeros as dashes, percentages with one decimal), ensures all calculations use formulas rather than hardcoded values, runs the recalc.py script to verify formula calculations, and checks for and resolves any formula errors.",
  "files": [
    "document-skills/xlsx/SKILL.md",
    "document-skills/xlsx/recalc.py"
  ]
}