{
  "skill_name": "document-skills/xlsx",
  "task": "I need to build a product profitability analyzer for our e-commerce business. We sell 5 products across 3 sales channels (Online, Retail, Wholesale) with different pricing and cost structures.\n\n**Product Data:**\n- Product A: Base cost $25, Online price $60, Retail price $55, Wholesale price $45\n- Product B: Base cost $40, Online price $95, Retail price $88, Wholesale price $72\n- Product C: Base cost $15, Online price $38, Retail price $35, Wholesale price $28\n- Product D: Base cost $80, Online price $180, Retail price $165, Wholesale price $135\n- Product E: Base cost $12, Online price $30, Retail price $28, Wholesale price $22\n\n**Q1 2024 Unit Sales by Channel:**\n- Online: Product A (850), Product B (620), Product C (1240), Product D (310), Product E (1580)\n- Retail: Product A (640), Product B (480), Product C (920), Product D (245), Product E (1150)\n- Wholesale: Product A (1200), Product B (890), Product C (1650), Product D (420), Product E (2100)\n\n**Channel Operating Costs (% of channel revenue):**\n- Online: 15% (shipping, platform fees, payment processing)\n- Retail: 25% (store rent, staff, utilities)\n- Wholesale: 8% (logistics, account management)\n\nCreate an Excel workbook with the following sheets:\n\n1. **Product Master** sheet: Organize all product costs and prices by channel in a structured table. Include a column calculating the gross margin percentage for each product-channel combination.\n\n2. **Sales Data** sheet: Show Q1 unit sales in a matrix format (products as rows, channels as columns) with a total units column that sums across all channels for each product.\n\n3. **Revenue Analysis** sheet: Calculate total revenue for each product-channel combination using formulas that reference the Product Master prices and Sales Data units. Include subtotals by product (across all channels) and by channel (across all products), plus a grand total.\n\n4. **Profitability Dashboard** sheet: This is the key analysis sheet that should calculate:\n   - Gross profit for each product-channel combination (Revenue minus product costs)\n   - Operating profit after applying channel operating cost percentages\n   - Net profit margin percentage for each combination\n   - Identify the most and least profitable product overall using MAX/MIN functions with cell references showing the product name\n   - Calculate which channel generates the highest total operating profit\n   - Show a profitability ranking for all 15 product-channel combinations using the RANK function\n\nAll monetary values must be formatted as currency with thousand separators and zeros displaying as dashes. Percentages should show one decimal place. Use blue text for all input data (costs, prices, sales units, operating cost percentages), black text for calculated formulas, and green text for any cross-sheet references. Every calculation must use cell references to the source data - absolutely no hardcoded calculations. The final workbook must have zero formula errors when all formulas are recalculated.",
  "rubric_task_completion": "1. The workbook contains exactly four sheets (Product Master, Sales Data, Revenue Analysis, Profitability Dashboard) with all required data properly organized: Product Master has costs/prices/margins for all 5 products across 3 channels, Sales Data shows the Q1 unit sales matrix, Revenue Analysis calculates revenues with proper subtotals and grand total, and Profitability Dashboard includes gross profit, operating profit, net margins, most/least profitable product identification, highest profit channel, and profitability rankings.\n\n2. All calculations use Excel formulas with cell references rather than hardcoded values: revenue calculations reference both price and unit data from other sheets/cells, profit calculations reference revenue and cost cells, margin percentages are calculated as formulas dividing profit by revenue, and the most/least profitable products and highest profit channel are identified using Excel functions (MAX/MIN/RANK) with proper cell references.\n\n3. Proper formatting is applied throughout: all currency values display with dollar signs and thousand separators (e.g., $1,000), zeros are formatted to display as dashes using number format codes, percentages show exactly one decimal place (e.g., 15.5%), and the data follows the color-coding convention with blue text for inputs, black text for formulas, and green text for cross-sheet references.\n\n4. The workbook is functionally complete with zero formula errors: all formulas calculate correctly without any #REF!, #DIV/0!, #VALUE!, #N/A, or #NAME? errors, the profitability analysis correctly identifies the most/least profitable products and channels, the RANK function properly orders all 15 product-channel combinations by profitability, and all cross-sheet references link correctly between the four worksheets.",
  "rubric_skill_use": "1. The agent correctly identifies that the xlsx skill is appropriate for this task involving creating a multi-sheet Excel workbook with formulas, formatting, and data analysis.\n\n2. The agent loads the SKILL.md file from the document-skills/xlsx skill to understand the requirements for Excel file creation, formula construction, formatting standards, and the workflow for creating spreadsheets with formulas.\n\n3. The agent loads and uses the recalc.py script to recalculate all formulas in the created workbook and verify there are zero formula errors, checking the JSON output from the script to confirm successful formula evaluation.\n\n4. The agent appropriately applies the skill's guidelines by: using openpyxl to create the workbook with formulas rather than pandas with hardcoded calculations, following the color-coding standards (blue for inputs, black for formulas, green for cross-sheet references), applying the number formatting standards (currency with thousand separators, zeros as dashes, percentages with one decimal), using cell references instead of hardcoded values in all formulas, running the recalc.py script after creating the file, and verifying zero formula errors in the final output.",
  "files": [
    "document-skills/xlsx/SKILL.md",
    "document-skills/xlsx/recalc.py"
  ]
}