{
  "skill_name": "xlsx",
  "task": "I'm preparing a product portfolio analysis for our executive team. We manufacture three product lines (Alpha, Beta, Gamma) across four quarters in 2024, and I need you to build a comprehensive workbook that analyzes profitability and market positioning.\n\n**Q1 2024 Data:**\n- Alpha: 8,500 units sold, $120 per unit, $65 COGS per unit, $180K marketing spend\n- Beta: 12,300 units sold, $85 per unit, $48 COGS per unit, $225K marketing spend\n- Gamma: 6,200 units sold, $210 per unit, $125 COGS per unit, $165K marketing spend\n\n**Q2 2024 Data:**\n- Alpha: 9,350 units sold, $122 per unit, $67 COGS per unit, $195K marketing spend\n- Beta: 13,530 units sold, $87 per unit, $49 COGS per unit, $240K marketing spend\n- Gamma: 7,440 units sold, $215 per unit, $128 COGS per unit, $178K marketing spend\n\n**Q3 2024 Data:**\n- Alpha: 10,285 units sold, $125 per unit, $68 COGS per unit, $210K marketing spend\n- Beta: 14,883 units sold, $88 per unit, $50 COGS per unit, $255K marketing spend\n- Gamma: 8,928 units sold, $218 per unit, $130 COGS per unit, $192K marketing spend\n\n**Q4 2024 Data:**\n- Alpha: 11,314 units sold, $127 per unit, $70 COGS per unit, $225K marketing spend\n- Beta: 16,371 units sold, $90 per unit, $51 COGS per unit, $270K marketing spend\n- Gamma: 10,714 units sold, $222 per unit, $133 COGS per unit, $205K marketing spend\n\nCreate a workbook with four sheets:\n\n1. **Raw Data** sheet: Organize all quarterly data in a structured table (columns: Quarter, Product, Units, Price, COGS per Unit, Marketing Spend)\n\n2. **Profitability Analysis** sheet: Using formulas only (no hardcoded calculations), calculate for each product in each quarter: Gross Revenue, Total COGS, Gross Profit, Gross Margin %, Contribution Margin (Gross Profit minus Marketing), and Contribution Margin %. Include quarterly totals across all products and annual totals by product.\n\n3. **Growth Metrics** sheet: Calculate quarter-over-quarter growth rates for units sold, average selling price changes, and COGS per unit changes for each product. Also show which product had the highest unit growth rate overall (use MAX and INDEX/MATCH formulas to identify).\n\n4. **Portfolio Summary** sheet: Pull data from other sheets to show each product's percentage of total annual revenue, total annual contribution margin, average quarterly gross margin %, and marketing efficiency ratio (total contribution margin divided by total marketing spend). Rank the products by contribution margin using the RANK function.\n\nApply proper financial formatting: currency in thousands with 'k' notation where appropriate, percentages to one decimal place, zeros as dashes. Use color coding standards (blue for any assumption cells if needed, black for formulas, green for cross-sheet references). The workbook must have zero formula errors after recalculation.",
  "rubric_task_completion": "1. All four required sheets are created with appropriate names and structure: Raw Data contains the organized source data in table format; Profitability Analysis contains revenue, cost, profit, and margin calculations; Growth Metrics contains quarter-over-quarter growth rates and identification of highest growth product; Portfolio Summary contains annual aggregations, rankings, and cross-sheet references.\n2. All calculations use Excel formulas that reference appropriate cells rather than hardcoded values, including: revenue calculations (units \u00d7 price), COGS calculations (units \u00d7 COGS per unit), margin percentages, growth rates, totals/subtotals, and ranking functions (RANK, MAX, INDEX/MATCH or similar).\n3. Proper financial formatting is applied throughout: currency values display with thousand separators and appropriate units, percentages show one decimal place (0.0%), zeros display as dashes using number format codes, and negative numbers use parentheses notation.\n4. The workbook contains zero formula errors (#REF!, #DIV/0!, #VALUE!, #N/A, #NAME?) after recalculation, and all formulas calculate correctly with accurate results that can be verified against the source data.",
  "rubric_skill_use": "1. The agent identifies and selects the xlsx skill as the appropriate skill for creating a comprehensive spreadsheet workbook with formulas, formatting, and multi-sheet analysis.\n2. The agent loads and references the SKILL.md file from the xlsx skill, demonstrating understanding of requirements such as using formulas instead of hardcoded values, proper formatting conventions, color coding standards, and the mandate for zero formula errors.\n3. The agent uses the recalc.py script (additional file from the xlsx skill) to recalculate all formulas in the workbook after creation, and checks the JSON output to verify zero errors are present.\n4. The agent correctly applies xlsx skill principles throughout the solution: uses openpyxl for creating the workbook with formulas and formatting, writes formulas as strings (e.g., '=SUM(A1:A10)') rather than calculating values in Python, applies appropriate number formatting codes for zeros-as-dashes, implements cross-sheet references using proper syntax, and follows the verification checklist for formula correctness including testing cell references and checking for common errors.",
  "files": [
    "document-skills/xlsx/SKILL.md",
    "document-skills/xlsx/recalc.py"
  ]
}