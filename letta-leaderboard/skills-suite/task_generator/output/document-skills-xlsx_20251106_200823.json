{
  "skill_name": "xlsx",
  "task": "I'm preparing a company-wide budget allocation analysis. Here's the department budget data for our organization:\n\n**Engineering Department:**\n- Salaries: $2,400,000\n- Equipment: $350,000\n- Software Licenses: $180,000\n- Training: $75,000\n- Travel: $45,000\n\n**Sales Department:**\n- Salaries: $1,800,000\n- Commissions: $920,000\n- Marketing Programs: $450,000\n- Travel: $280,000\n- Events: $150,000\n\n**Operations Department:**\n- Salaries: $1,200,000\n- Facilities: $540,000\n- Equipment: $220,000\n- Supplies: $95,000\n- Utilities: $85,000\n\n**Finance & Admin:**\n- Salaries: $950,000\n- Software: $125,000\n- Professional Services: $180,000\n- Insurance: $95,000\n- Other: $50,000\n\nCreate a multi-sheet budget workbook with:\n\n1. **Department Budgets** sheet: Organize all budget line items by department with subtotals for each department calculated using formulas.\n\n2. **Budget Summary** sheet: Create a summary view showing total budget by department, percentage of total company budget for each department (calculated with formulas), and total company budget. Include a breakdown of total spending by category across all departments (e.g., total salaries across all departments, total travel across all departments).\n\n3. **Variance Analysis** sheet: Set up a scenario analysis where you can adjust each department's budget by a percentage (create assumption cells for Department Budget Adjustment % - Engineering: 5%, Sales: -3%, Operations: 2%, Finance: 0%). Show the original budget, adjusted budget (calculated with formulas), and variance in dollars and percentage. Calculate the new company total and overall variance from original budget.\n\n4. **Cost per Employee** sheet: Given employee counts (Engineering: 48, Sales: 32, Operations: 28, Finance: 15), calculate the total budget per employee for each department and rank departments by cost per employee using appropriate Excel functions.\n\nAll calculations must use Excel formulas with cell references - absolutely no hardcoded computed values. Format all currency with thousand separators and include units in headers (e.g., 'Budget ($)'). Display zeros as dashes. Use color coding: blue text for input values, black for formulas, green for cross-sheet references. Ensure the workbook has zero formula errors after recalculation.",
  "rubric_task_completion": "1. All four required sheets are created (Department Budgets, Budget Summary, Variance Analysis, Cost per Employee) with the specified data and structure\n2. Department Budgets sheet contains all line items organized by department with formula-calculated subtotals; Budget Summary sheet shows department totals, percentage calculations, and category breakdowns across departments\n3. Variance Analysis sheet includes adjustment percentage cells (5%, -3%, 2%, 0%), formulas calculating adjusted budgets and variances in both dollars and percentages, and overall company variance\n4. Cost per Employee sheet includes the given employee counts (48, 32, 28, 15), calculates budget per employee for each department using formulas, and ranks departments using Excel ranking functions",
  "rubric_skill_use": "1. The xlsx skill is selected for handling this spreadsheet creation task with multiple sheets, formulas, formatting, and cross-sheet references\n2. The SKILL.md file from the xlsx skill is loaded to access instructions on creating Excel files with formulas, formatting standards, and recalculation procedures\n3. The recalc.py script is used to recalculate all formulas after creating the workbook and verify zero formula errors\n4. The skill is used appropriately by: (a) using openpyxl to create the workbook with formulas (not hardcoded calculations), (b) applying proper financial formatting including color coding (blue for inputs, black for formulas, green for cross-sheet references), currency formatting with thousand separators, and zeros as dashes, (c) running recalc.py to ensure all formulas are calculated and checking for errors, and (d) creating cross-sheet references where the Budget Summary and other sheets pull from the Department Budgets sheet",
  "files": [
    "document-skills/xlsx/SKILL.md",
    "document-skills/xlsx/recalc.py"
  ]
}