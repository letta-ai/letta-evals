## QUALITY RUBRIC FOR FILE NAVIGATION BENCHMARK

### 1. THE PARALLELIZATION TEST (MOST IMPORTANT)

Before accepting ANY question, ask: "Can the agent run all conditions as independent greps and intersect?"

- **REJECT if parallelizable**:
  - "Who has a Mastercard, owns a dog, and lives in Texas?"
    → All 3 conditions can be grepped independently
  - "Among people with O+ blood who own dogs, who has the highest salary?"
    → Both filters (O+ blood, owns dogs) are parallel greps
  - Any question where ALL conditions can be evaluated independently

- **ACCEPT if truly sequential**:
  - Step N's output is step N+1's query INPUT
  - You cannot write the next grep until the previous completes
  - At least one step involves an INDIRECT RELATIONSHIP

### 2. INDIRECT RELATIONSHIPS (REQUIRED)

Questions must include at least one relationship that cannot be grepped directly:

- **Coworker**: same employer (must find employer first)
- **Neighbor/Same city**: must find the city first, then find others
- **Financial peer**: same bank (must find bank first)
- **Same state**: must find state first, then find others

Examples:
- GOOD: "What pet does the COWORKER of person X own?"
- BAD: "What pet does person X own?" (direct lookup)

### 3. COMPLEXITY TIERS

- **Too Easy (REJECT)**:
  - Parallelizable conditions
  - Single candidate at each step (just following breadcrumbs)
  - Single aggregation (just "sum person X's records")
  - Example: "What pet does the person with plate XYZ own?" (2 hops, direct)
  - Example: "What is the total balance of the coworker of person X?" (only 1 coworker)

- **Medium (ACCEPT with caution)**:
  - 4-5 file lookups with sequential dependencies
  - One step with multiple candidates requiring comparison
  - Example: "Among the 5 employees at company X, who has the most pets?"

- **Hard (ACCEPT, PREFERRED)**:
  - 5-6 file lookups with multiple comparison/aggregation steps
  - Intermediate steps return 5-15 candidates that must be compared
  - Nested superlatives: "Among people with the highest X, who has the lowest Y?"
  - Aggregate-then-filter: "Among the top 10 by X, who matches condition Y?"
  - Conditional chains: "If X > Y, return A. Otherwise, return B."
  - Example: "What is the total balance of the person with the most credit cards among employees at the company where the owner of pet 'Buddy' works?"

### 4. ANSWER QUALITY

- **REJECT if answer is**:
  - A negation: "does not own", "None", "no record found"
  - Ambiguous: person has multiple matching records
  - A list without clear ordering

- **ACCEPT if answer is**:
  - A specific name: "John Smith"
  - A specific number: "$145,315.33", "4 vehicles"
  - A specific date: "2025-06-19"

### 5. GROUP SIZE FOR COMPARISONS

- Groups defined by chains (coworkers, same-city residents) should be 5-15 people
- Too small (3) = trivial enumeration
- Too large (50+) = not feasible with grep

### 6. CLOSE COMPARISONS (KEY TO DIFFICULTY)

For any comparison question, the top candidates should have CLOSE values:
- **Bank balances**: within 5% of each other (e.g., $45,000 vs $44,500)
- **Dates**: within days/weeks (e.g., 2025-06-14 vs 2025-06-17)
- **Counts**: differ by only 1-2 (e.g., 4 credit cards vs 3 credit cards)

This is where models actually fail — they follow the right process but mess up close comparisons.

### 7. IDENTIFIER GUIDELINES

- **AVOID SSN** — triggers safety refusals in many models
- **AVOID "neighbor"** — ambiguous, models don't know what it means
- **PREFER**: license plates, internet usernames, pet names, email addresses, employer names
- **SAY EXPLICITLY**: "same city" or "same state" instead of "neighbor"

### 8. EVALUATION CHECKLIST

For each question:
1. **Parallelization test**: Can all conditions be grepped independently? → REJECT
2. **Multi-candidate test**: Does at least one step return 5+ candidates that must be compared? → REQUIRED
3. **Sequential test**: Write out the steps. Does step N+1 require step N's result? → GOOD
4. **Indirect relationship**: Is there at least one derived relationship (coworker, same city)? → REQUIRED
5. **Close comparisons**: If comparing values, are the top candidates within 5%? → REQUIRED
6. **No SSN/neighbor**: Does the question avoid SSN and "neighbor"? → REQUIRED
7. **Uniqueness**: Does verification_query return exactly 1 row? → REQUIRED
8. **File count**: Are 5-6 files truly required? → REQUIRED
9. **Concrete answer**: Is it a name/number/date, not a negation? → REQUIRED

### 9. ADVANCED PATTERNS (at least one required)

- **Nested superlatives**: Multiple max/min operations (e.g., "highest among those with lowest")
- **Aggregate-then-filter**: Large set first (top N), then filter by condition
- **Conditional chains**: Different answer branches based on comparison result
- **Multi-step aggregation**: Select from group, THEN aggregate selected person's records
