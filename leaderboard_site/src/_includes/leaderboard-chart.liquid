{%- assign sorted_by_score = leaderboard_data | sort: "average" | reverse -%}
{%- assign max_score = sorted_by_score[0].average -%}
{%- assign sorted_by_cost = leaderboard_data | sort: "total_cost" -%}
{%- assign min_cost = sorted_by_cost[0].total_cost -%}
{%- assign sorted_by_cost_desc = leaderboard_data | sort: "total_cost" | reverse -%}
{%- assign max_cost = sorted_by_cost_desc[0].total_cost -%}
{%- assign cost_range = max_cost | minus: min_cost -%}
{%- for entry in sorted_by_score -%}
<div class="chart-row" data-model="{{ entry.model }}">
    <div class="chart-label">
        {%- assign provider = entry.model | split: "/" | first -%}
        <img src="./icons/{{ provider }}.svg" alt="{{ provider }}" class="model-icon">
        <span>{{ entry.model }}</span>
    </div>
    <div class="chart-bar-wrapper">
        <div class="chart-bar" style="width: {{ entry.average }}%"></div>
        <div class="chart-value">
            <span>{{ entry.average }}%</span>
            {%- if entry.total_cost <= 4 -%}
            {%- assign cost_normalized = entry.total_cost | divided_by: 4.0 -%}
            {%- assign hue = cost_normalized | times: -60 | plus: 120 -%}
            {%- else -%}
            {%- assign cost_over_threshold = entry.total_cost | minus: 4 -%}
            {%- assign remaining_range = max_cost | minus: 4 -%}
            {%- assign cost_normalized = cost_over_threshold | divided_by: remaining_range -%}
            {%- assign hue = cost_normalized | times: -60 | plus: 60 -%}
            {%- endif -%}
            <span class="cost-badge" style="background-color: hsl({{ hue }}, 70%, 45%); color: white;">${{ entry.total_cost }}</span>
        </div>
    </div>
</div>
{%- endfor -%}
